---
wts:
    title: '04 - 建立虛擬網路 (20 分鐘)'
    module: '模組 02 - 核心 Azure 服務 (工作負載)'
---
# 04 - 建立虛擬網路 (20 分鐘)

在這個逐步解說中，我們將建立一個虛擬網路，將兩個虛擬機器部署到該虛擬網路上，然後進行設定以允許一個虛擬機器 ping 該虛擬網路中的另一個虛擬機器。

# 工作 1：建立虛擬網路 

在這個工作中，我們將建立一個虛擬網路。 

附註：在開始實驗室之前，透過開啟 [開始] 功能表 > [設定] > [網路和網際網路] > [找到 Windows 防火牆]，停用虛擬機器中的公用和專用防火牆

1. 登入到 Azure 入口網站，網址：<a href="https://portal.azure.com" target="_blank"><span style="color: #0066cc;" color="#0066cc">https://portal.azure.com</span></a>

2. 從 [**所有服務**] 刀鋒視窗，搜尋並選取 [**虛擬網路**]，然後按一下 [**+ 新增、+ 建立、+ 新建**]。 

3. 在 [**基本**] 索引標籤中，填充下列資訊 (其他內容保留預設值)：

    | 設定 | 值 | 
    | --- | --- |
    | 訂用帳戶 | **保留提供的預設值** |
    | 資源群組 | **建立新資源群組** |
    | 名稱 | **vnet1** |
    | 區域 | **美國東部** |
    
   
4. 按一下 [**檢閱 + 建立**] 按鈕。確保驗證通過。然後按一下 [建立] 來部署資源。


# 工作 2：建立二個虛擬機器

在這個工作中，我們將在虛擬網路中建立兩個虛擬機器。 

1. 從 [**所有服務**] 刀鋒視窗，搜尋 [**虛擬機器**]，然後按一下 [**+ 新增、+ 建立、+ 新建**] 並從下拉式功能表中選取 [**虛擬機器**]。 

2. 在 [**基本**] 索引標籤中，填充下列資訊 (其他內容保留預設值)：

   | 設定 | 值 | 
   | --- | --- |
   | 訂用帳戶 | **使用提供的預設值** |
   | 資源群組 |  **在下拉式功能表中選取預設值** |
   | 虛擬機器名稱 | **vm1**|
   | 區域 | **美國東部** |
   | 映像 | **Windows Server 2019 資料中心 - Gen2** |
   | 使用者名| **azureuser** |
   | 密碼| **Pa$$w0rd1234** |
   | 公用輸入連接埠| 選取 [**允許選取的連接埠**]  |
   | 選取的輸入連接埠| **RDP (3389)** |
   

3. 選取 [**網路**] 索引標籤。確保虛擬機器位於 **vnet1** 虛擬網路中。檢閱預設設定，但不要進行任何其他變更。 

4. 按一下 [**檢閱 + 建立**]。驗證通過後，按一下 [**建立**]。部署時間可能會有所不同，但部署通常需要 3 到 6 分鐘。

5. 監視部署，但繼續下一步。 

6. 重複上面的步驟 **2 到 4**，再建立一個虛擬機器。確保使用不同的虛擬機器名稱，該虛擬機器位於同一虛擬網路中，並且使用新的公用 IP 位址：

    | 設定 | 值 |
    | --- | --- |
    | 資源群組 | **選取下拉式清單中的預設值 (如同工作 1-3 和工作 2-2)** |
    | 虛擬機器名稱 |  **vm2** |
    | 虛擬網路 | **vnet1** |
    | 公用 IP | **vm2** |

7. 等待兩個虛擬機器都部署完成，且狀態為 [*正在執行*]。

# 工作 3：測試連線 

在這個工作中，我們將嘗試測試虛擬機器是否可以相互通信 (ping)。如果不能，我們將安裝允許 ICMP 連線的規則。通常 ICMP 連線會被自動封锁。

1. 從 [**所有資源**] 刀鋒視窗，搜尋 **vm1**，開啟 [**概觀**] 刀鋒視窗，並確保其 [**狀態**] 為 [**正在執行**]。您可能需要 [**重新整理**] 頁面。

2. 在 [**概觀**] 刀鋒視窗上，選取 [**連線**]，然後從下拉式功能表中選取 [**RDP**]。

    **注意**：下列說明告訴您如何從 Windows 電腦連線到 VM。 

3. 在 [**使用 RDP 連線**] 刀鋒視窗中，保留預設選項以透過連接埠 3389 連線 IP 位址，然後按一下 [**下載 RDP 檔案**]。

4. 開啟下載的 RDP 檔案 (位於 VM 的左下角)，並在出現提示時按一下 [**連線**]。 

5. 在 [**Windows 安全性**] 視窗中，鍵入使用者名稱 **azureuser** 和密碼 **Pa$$w0rd1234**，然後按一下 [**確定**]。

6. 您可能在登入過程中收到證書警告。按一下 [**是**] 以建立連線並連線到部署的 VM。您應該連線成功。關閉彈出的 Windows Server 和儀錶板視窗。您應該會看到藍色的 Windows 背景。您現在處於您的虛擬機器中。

附註：在新建立的虛擬機器中，透過開啟 [開始] 功能表 > [設定] > [網路和網際網路] > [找到 Windows 防火牆]，停用公用和專用防火牆

7. 透過按一下 [**開始**] 按鈕開啟虛擬機器上的 PowerShell，然後在搜尋類型 **PowerShell** 中，以滑鼠右鍵按一下 [**Windows PowerShell**]，以便**以系統管理員身分執行**。

8. 在 Powershell 中，嘗試輸入以下內容來 ping vm2：

   ```PowerShell
   ping vm2
   ```

 9. 您應該成功。您已從 VM1 ping 了 VM2。


**恭喜！** 您已經在一個虛擬網絡中設定並部署了兩個虛擬機器，然後就可以連線它們了。

**注意**：為了避免額外的成本，您可以删除此資源群組。搜尋資源群組，按一下您的資源群組，然後按一下 [**删除資源群組**]。驗證資源群組的名稱，然後按一下 [**删除**]。監視 [**通知**] 以驗證删除的狀態。
