---
wts:
    title: '17 - 建立 Azure 原則 (10 分鐘)'
    module: '模組 05：描述身分識別、控管、隱私權和合規性功能'
---
# 17 - 建立 Azure 原則 (10 分鐘)

在這個逐步解說中，我們將建立 Azure 原則以將 Azure 資源的部署限制到特定位置。

# 工作 1：建立原則指派 

在這個工作中，我們將設定 [允許的位置] 原則並將其指派給我們的訂用帳戶。 

1. 登入到 [Azure 入口網站](https://portal.azure.com)。

2. 從 [**所有服務**] 刀鋒視窗，搜尋並㥷 [**原則**]，在 [**製作**] 區段下，按一下 [**定義**]。  請花點時間檢閱內置原則定義的清單。例如，在 [**類別**] 下拉式清單中，僅選取 [**計算**]。注意，[**允許的虛擬機器大小 SKU**] 定義使您能够指定組織可以部署的一組虛擬機器 SKU。

3. 返回到 [**原則**] 頁面，在 [**製作**] 區段，按一下 [**指派**]。指派是指已指派在特定範圍內執行的原則。例如，可以將定義指派給訂用帳戶範圍。 

4. 按一下 [**原則 - 指派**] 頁面頂部的 [**指派原則**]。

5. 在 [**指派原則**] 頁面，保留預設範圍。

      | 設定 | 值 | 
    | --- | --- |
    | 範圍| **使用選定的預設值**|
    | 原則定義 | 按一下省略號，然後搜尋 [**允許的位置**]，然後**選取** |
    | 指派名稱 | **允許的位置** |
    
    ![填寫欄位值並醒目提示 [選取] 按鈕的 [範圍] 窗格的螢幕擷取畫面。 ](../images/1402.png)
6. 在 [**參數**] 索引標籤上，選取 [**日本西部**]。按一下 [**檢閱 + 建立**]，然後按一下 [**建立**]。

    **注意**：範圍確定原則指派套用到哪些資源或資源群組。在本例中，我們可以將此原則指派給特定的資源群組，但是我們選擇在訂用帳戶級別指派原則。請注意，可以根據範圍設定排除資源。排除是選用的。

    **注意**：該 [**允許的位置**] 原則定義將指定所有資源必須部署到的位置。如果選擇了其他位置，則不允許部署。若需詳細資訊，請檢視 [Azure 原則範例](https://docs.microsoft.com/zh-tw/azure/governance/policy/samples/index)頁面。

   ![[可用定義] 窗格的螢幕擷取畫面，其中醒目提示了各個欄位，並選取了 [稽核不使用受管理磁碟的 VM] 選項。](../images/1403.png)

9. [**允許的位置**] 原則指派現在列在 [**原則 - 指派**] 窗格上，並且它現在已經就位，在我們指定的範圍級別 (訂用帳戶級別) 強制執行原則。

# 工作 2：測試 [允許的位置] 原則

在這個工作中，我們將測試 [允許的位置] 原則。 

1. 在 Azure 入口網站的 [**所有服務**] 刀鋒視窗，搜尋並選取 [**儲存體帳戶**]，然後按一下 [**+ 建立**]。

2. 設定儲存體帳戶 (將儲存體帳戶名稱中的 **xxxx** 替換為字母和數位，以便名稱具有全域唯一性)。其他內容都保留預設值。 

    | 設定 | 值 | 
    | --- | --- |
    | 訂用帳戶 | **使用提供的預設值** |
    | 資源群組 | **myRGPolicy** (新增) |
    | 儲存體帳戶名稱 | **storageaccountxxxx** |
    | 位置 | **美國東部** |

3. 按一下 [**檢閱 + 建立**]，然後按一下 [**建立**]。 

4. 您將收到**部署失敗**錯誤，說明原則不允許使用資源，包括 [**允許的位置**] 原則名稱。

# 工作 3：刪除原則指派

在這個工作中，我們將刪除 [允許的位置] 原則指派並進行測試。 

我們將删除原則指派，以確保我們在未來想完成的工作中不會遭到封鎖。

1. 從 [**所有服務**] 刀鋒視窗，搜尋並選取 [**原則**]，然後按一下 [**允許的位置**] 原則。

    **注意**：在 [**原則**] 刀鋒視窗，您可以檢視已指派的各種原則的合規性狀態。

    **注意**：[允許的位置] 原則可能顯示不符合的資源。如果是，則這些是在原則指派之前建立的資源。
 
2. 按一下 [**允許的位置**]，這會開啟 [允許的位置原則合規性] 視窗。

3. 按一下頂部功能表的 [**刪除指派**]。按一下 [**是**] 確認要删除策略指派

   ![[删除指派] 功能表項目的螢幕擷取畫面。](../images/1407.png)

4. 嘗試建立另一個儲存體帳戶以確保原則不再有效。

    **注意**：[**允許的位置**] 原則可能有用的常見場景包括： 
    - *成本跟蹤*：您可以為不同的區域位置提供不同的訂用帳戶。該原則將確保所有資源都部署在預期區域，以協助跟踪成本。 
    - *資料駐落地和安全性與合規性*：您還可以具有資料落地需求，並為每個客戶或特定工作負載建立訂用帳戶，並定義必須在特定資料中心部署所有資源，以確保符合資料和安全性需求。

恭喜！您已建立 Azure 原則以限制將 Azure 資源部署到特定資料中心。

**注意**：為了避免額外的成本，您可以删除此資源群組。搜尋資源群組，按一下您的資源群組，然後按一下 [**删除資源群組**]。驗證資源群組的名稱，然後按一下 [**删除**]。監視 [**通知**] 以驗證删除的狀態。
